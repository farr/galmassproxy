Galaxy Mass Proxy Fitting
=========================

This code implements a "regression" on galaxy mass proxies.  Given
observations of galaxy mass and a suitable proxy for mass, with
associated errors, it fits a model to the data and returns posteriors
on model parameters.  Using these posteriors, subsequent observations
of either the proxy, the mass, or both can be turned into a posterior
on the true mass of the galaxy; in other words, the regression can be
"inverted" to predict the quantity of interest (mass), exploiting all
the available data (mass/proxy observations if available).

The Model
---------

The model that is fit is the following.  Given observations of Mobs
and proxy with errors dM and dp, we assume that these are generated by
the following model:

log(Mobs) ~ N(log(Mtrue), dM/Mobs)
log(proxy) ~ N(log(alpha*Mtrue + beta), sqrt(dp^2 + sigma^2)/proxy)

with Mtrue, alpha, beta, sigma parameters.  In words: the observed
mass is normally distributed about the true mass with width equal to
the quoted observational errors; the observed proxy is normally
distributed about the linear relationship alpha*Mtrue + beta with
width given by a combination of intrinsic scatter (sigma) and
observational error (dp).

When fitting, we assume a prior on log(Mtrue) that is uniform.  Priors
on alpha, beta, and sigma are Jeffreys.

Installation/Running
--------------------

The model is encoded in posterior.py's Posterior class.  It is
intended for use with the [emcee](http://dan.iel.fm/emcee/current/)
sampler.  Note that Posterior includes routines for computing the
expected value of Mtrue given parameters and a subsequent observation
of Mobs and proxy with errors.  In other words, once a relation has
been fit, it can be exploited to improve the accuracy of subsequent
observations, in a manner consistent with the posterior on model
parameters.

The code in plots.py permits to generate plots illustrating the fit.

License
-------

This code is released under the [MIT
License](http://opensource.org/licenses/MIT).  See the file LICENSE
for details.